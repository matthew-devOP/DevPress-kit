# Load required modules
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so

# Minimal Apache configuration for WordPress + PHP-FPM
DirectoryIndex index.php index.html

# Enable AllowOverride for .htaccess
<Directory "/usr/local/apache2/htdocs">
    AllowOverride All
    Require all granted
    Options -Indexes
</Directory>

# PHP-FPM configuration via proxy
ProxyPassMatch ^/(.*\.php(/.*)?)$ fcgi://php-fpm:9000/var/www/html/$1

# Direct PHP file handling
<FilesMatch \.php$>
    SetHandler "proxy:fcgi://php-fpm:9000"
</FilesMatch>
